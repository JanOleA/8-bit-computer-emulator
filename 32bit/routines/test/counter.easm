;! name: Counter
;! entry: main
;! abi: os
;! deps: newline, multiply, display_number

ZERO = 0
counter = .bss
counter2 = .bss + 1
result = .bss + 2
result2 = .bss + 3
input1 = .bss + 4
input2 = .bss + 5
t2_input1 = .bss + 6
t2_input2 = .bss + 7
.digits = "0123456789"

main:
  LDI 5
  STA .counter
  LDI 2
  STA .counter2
MAIN__WHILE_START_1:
  LDA .counter
  CPI 0
  JPZ MAIN__WHILE_END_2
  LDA .counter
  SUI 1
  STA .counter
  LDA .counter2
  PHA
  LDA .counter
  PHA
  JSR @multiply
  STA .result
  LDA .result
  PHA
  JSR @display_number
  JMP MAIN__WHILE_START_1
MAIN__WHILE_END_2:
  JSR @newline
  LDI 8
  PHA
  LDI 7
  PHA
  JSR test
  PLA
  STA .result
  PLA
  STA .result2
  LDA .result
  PHA
  JSR @display_number
  JSR @newline
  LDA .result2
  PHA
  JSR @display_number
  JSR @newline
  LDI 20
  PHA
  LDI 10
  PHA
  JSR test2
  STA .result
  LDA .result
  PHA
  JSR @display_number
  JSR @newline
  RET

test:
  PLA
  MOVAB
  PLA
  STA .input1
  PLA
  STA .input2
  MOVBA
  PHA
  LDI 3
  ADD .input1
  STA .counter
  LDI 4
  ADD .input2
  STA .counter2
  PLA
  MOVAB
  LDA .counter2
  PHA
  LDA .counter
  PHA
  MOVBA
  PHA
  RET

test2:
  PLA
  MOVAB
  PLA
  STA .t2_input1
  PLA
  STA .t2_input2
  MOVBA
  PHA
  LDA .t2_input1
  ADD .t2_input2
  STA .result
  LDA .result
  RET

